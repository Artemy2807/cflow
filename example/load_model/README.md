 # Example load_model 
В данном примере продемонстрировано использование библиотеки CFLOW. Показано как загрузить ранее обученную модель и использовать её.

## [main.cpp](main.cpp)
Подключаем файл библиотеки и используем пространства имён.
- tf - пространство имён библиотеки CFLOW
- cv - пространство имён библиотеки технического зрения OpenCV
 ```c++
 #include "model.hpp"

using namespace tf;
using namespace cv;
 ```

Объявляем главную функцию программы main и создаём класс для работы с библиотекой CFLOW. Далее загружаем ранее обученную модель. "model_train.pb" - путь до файла модели.
```c++
int main() {
    Model model;
    model.load("model_train.pb");
```

Загружаем картинку из файла с помощью функции imread(). "test.jpg" - путь до картинки. Далее создаём структуру mat_info. Перед тем как послать изображение в нейронную сеть его необходимо обработать. Чтобы не выполнять обработку изображения вручную, необходимо заполнить структуру. info.type - пространство цветов в котором передаётся изображение в нейронную сеть. 
Возможны варианты:
- NONE - пространство цветов не изменяется. По умолчанию OpenCV загружает изображение в пространстве цветов BGR (Blue-Green-Red).
- RGB - пространство цветов изменяется на RGB (Red-Green-Bue).
- GRAY - пространство цветов изменяется на чёрно-белое.

info.size - размер входной картинки. Первым параметром устанавливается ширина картинки. Вторым параметром устанавливается высота картинки. Чтобы инициализировать данный параметр, используйте функцию std::make_pair. info.range - диапазон цвета каждого пикселя на изображение. 
Возможны варианты:
- STANDART - стандартный диапазон, от 0 до 255.
- BINARIZE - диапазон от 0 до 1. Возможны промежуточные значение, например 0.5.
```c++
   Mat img = imread("test.jpg");
   mat_info info;
   info.type = NONE; 
   info.size = std::make_pair(48, 48);
   info.range = BINARIZE;
```

Используем нейронную сеть для получения ответов на входные данные. img - входное изображение, относится к классу Mat. info - структура с информацией о том как обработать изображение перед передачей в нейронную сеть. output - вектор с ответами нейронной сети. После использования нейронной сети выводим ответы с помощью цикла for и завершаем программу.
```c++
    std::vector<float> output = model.predict(img, info);
    for(sze_t i = 0; i < output.size(); i++)
        printf("[%ld]: %f\n", i, output[i]);
    return 0;
}
```

## Возможные ошибки 

При выполнении программы может произойти ошибки. Ниже показаны ошибки и что они означают.
| Текст ошибки | Что значить ошибка |
|:-------|:-----|
| [ERROR]: model {путь до модели} not found | Программа не нашла файл модели нейронной сети |
| [ERROR]: model {путь до модели} is empty | Файл с моделью нейронной сети пустой |
| [ERROR]: unable to import model {путь до модели} | Файл с моделью нейронной сети повреждён или имеет не поддерживаемый формат |
| [ERROR]: create session is failed | Не возможно создать сессию для работы с нейронной сетью. Попробуйте пересобрать проект и заново запустить |
| [ERROR]: there are empty elements in the input vector | Вектор с входными данными для нейронной сети пустой |
| [ERROR]: the size of the vector with the responses of the neural network must be greater than 0. | Вектор с ответами нейронной сети пустой | 
| [ERROR]: run neural network is failed | Ошибка при запуске нейронной сети. Попробуйте пересобрать проект и заново запустить |
| [ERROR]: get tensor shape is failed | Не удалось получить размер входных данных для тензора. Попробуйте пересобрать проект и заново запустить |
| [ERROR]: empty data in function set | Пустые входные данные. Создайте данные перед передачей в функцию set, класса Tensor |
| [ERROR]: provided type is different from Tensor expected type | Тип входных данных отличается от типа входных данных операции |
| [ERROR]: an error occurred allocating the Tensor memory | Ну удалось создать новый Tensor. Попробуйте пересобрать проект и заново запустить |



